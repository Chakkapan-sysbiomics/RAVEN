<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of writeYaml</title>
  <meta name="keywords" content="writeYaml">
  <meta name="description" content="writeYaml">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">io</a> &gt; writeYaml.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for io&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>writeYaml
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>writeYaml</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function writeYaml(model,name,preserveQuotes,sortIds) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> writeYaml
   Writes a yaml file matching (roughly) the cobrapy yaml structure

   model           a model structure
   name            name that the file will have
   preserveQuotes  if quotes should be preserved for strings
                   (logical, default=true)
   sortIds         if metabolites, reactions, genes and compartments
                   should be sorted alphabetically by their identifier,
                   otherwise they are kept in their original order
                   (logical, default=false)

   Usage: writeYaml(model,name,preserveQuotes,sortIds)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="exportForGit.html" class="code" title="function out=exportForGit(model,prefix,path,formats,masterFlag,subDirs)">exportForGit</a>	exportForGit</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function writeField(model,fid,fieldName,type,pos,name,preserveQuotes)</a></li><li><a href="#_sub2" class="code">function writeMetadata(model,fid)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function writeYaml(model,name,preserveQuotes,sortIds)</a>
0002 <span class="comment">% writeYaml</span>
0003 <span class="comment">%   Writes a yaml file matching (roughly) the cobrapy yaml structure</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%   model           a model structure</span>
0006 <span class="comment">%   name            name that the file will have</span>
0007 <span class="comment">%   preserveQuotes  if quotes should be preserved for strings</span>
0008 <span class="comment">%                   (logical, default=true)</span>
0009 <span class="comment">%   sortIds         if metabolites, reactions, genes and compartments</span>
0010 <span class="comment">%                   should be sorted alphabetically by their identifier,</span>
0011 <span class="comment">%                   otherwise they are kept in their original order</span>
0012 <span class="comment">%                   (logical, default=false)</span>
0013 <span class="comment">%</span>
0014 <span class="comment">%   Usage: writeYaml(model,name,preserveQuotes,sortIds)</span>
0015 
0016 <span class="keyword">if</span> nargin &lt; 3
0017     preserveQuotes = true;
0018 <span class="keyword">end</span>
0019 <span class="keyword">if</span> nargin &lt; 4
0020     sortIds = false;
0021 <span class="keyword">end</span>
0022 
0023 <span class="keyword">if</span> ~endsWith(name,{<span class="string">'.yml'</span>,<span class="string">'.yaml'</span>})
0024     name = strcat(name,<span class="string">'.yml'</span>);
0025 <span class="keyword">end</span>
0026 
0027 <span class="comment">%Check that model is in RAVEN format:</span>
0028 <span class="keyword">if</span> isfield(model,<span class="string">'rules'</span>)
0029     model = ravenCobraWrapper(model);
0030 <span class="keyword">end</span>
0031 
0032 <span class="comment">%Simplify Miriam fields:</span>
0033 <span class="keyword">if</span> isfield(model,<span class="string">'metMiriams'</span>)
0034     [model.newMetMiriams,model.newMetMiriamNames]   = extractMiriam(model.metMiriams);
0035     model.newMetMiriams                             = regexprep(model.newMetMiriams,<span class="string">'^.+/'</span>,<span class="string">''</span>);
0036 <span class="keyword">end</span>
0037 <span class="keyword">if</span> isfield(model,<span class="string">'rxnMiriams'</span>)
0038     [model.newRxnMiriams,model.newRxnMiriamNames]   = extractMiriam(model.rxnMiriams);
0039     model.newRxnMiriams                             = regexprep(model.newRxnMiriams,<span class="string">'^.+/'</span>,<span class="string">''</span>);
0040 <span class="keyword">end</span>
0041 <span class="keyword">if</span> isfield(model,<span class="string">'geneMiriams'</span>)
0042     [model.newGeneMiriams,model.newGeneMiriamNames] = extractMiriam(model.geneMiriams);
0043     model.newGeneMiriams                            = regexprep(model.newGeneMiriams,<span class="string">'^.+/'</span>,<span class="string">''</span>);
0044 <span class="keyword">end</span>
0045 <span class="keyword">if</span> isfield(model,<span class="string">'compMiriams'</span>)
0046     [model.newCompMiriams,model.newCompMiriamNames] = extractMiriam(model.compMiriams);
0047     model.newCompMiriams                            = regexprep(model.newCompMiriams,<span class="string">'^.+/'</span>,<span class="string">''</span>);
0048 <span class="keyword">end</span>
0049 
0050 <span class="comment">%Open file:</span>
0051 fid = fopen(name,<span class="string">'wt'</span>);
0052 fprintf(fid,<span class="string">'---\n!!omap\n'</span>);
0053 
0054 <span class="comment">%Insert file header (metadata)</span>
0055 <a href="#_sub2" class="code" title="subfunction writeMetadata(model,fid)">writeMetadata</a>(model,fid);
0056 
0057 <span class="comment">%Metabolites:</span>
0058 fprintf(fid,<span class="string">'- metabolites:\n'</span>);
0059 <span class="keyword">if</span> sortIds==true
0060     [~,pos] = sort(model.mets);
0061 <span class="keyword">else</span>
0062     pos = 1:numel(model.mets);
0063 <span class="keyword">end</span>
0064 <span class="keyword">for</span> i = 1:length(model.mets)
0065     fprintf(fid,<span class="string">'    - !!omap\n'</span>);
0066     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'mets'</span>,        <span class="string">'txt'</span>, pos(i), <span class="string">'  - id'</span>,          preserveQuotes)
0067     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'metNames'</span>,    <span class="string">'txt'</span>, pos(i), <span class="string">'  - name'</span>,        preserveQuotes)
0068     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'metComps'</span>,    <span class="string">'txt'</span>, pos(i), <span class="string">'  - compartment'</span>, preserveQuotes)
0069     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'metFormulas'</span>, <span class="string">'txt'</span>, pos(i), <span class="string">'  - formula'</span>,     preserveQuotes)
0070     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'metCharges'</span>,  <span class="string">'num'</span>, pos(i), <span class="string">'  - charge'</span>,      preserveQuotes)
0071     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'inchis'</span>,      <span class="string">'txt'</span>, pos(i), <span class="string">'  - inchis'</span>,      preserveQuotes)
0072     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'metMiriams'</span>,  <span class="string">'txt'</span>, pos(i), <span class="string">'  - annotation'</span>,  preserveQuotes)
0073     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'metFrom'</span>,     <span class="string">'txt'</span>, pos(i), <span class="string">'  - metFrom'</span>,     preserveQuotes)
0074 <span class="keyword">end</span>
0075 
0076 <span class="comment">%Reactions:</span>
0077 fprintf(fid,<span class="string">'- reactions:\n'</span>);
0078 <span class="keyword">if</span> sortIds==true
0079     [~,pos] = sort(model.rxns);
0080 <span class="keyword">else</span>
0081     pos = 1:numel(model.rxns);
0082 <span class="keyword">end</span>
0083 <span class="keyword">for</span> i = 1:length(model.rxns)
0084     fprintf(fid,<span class="string">'    - !!omap\n'</span>);
0085     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'rxns'</span>,                 <span class="string">'txt'</span>, pos(i), <span class="string">'  - id'</span>,                    preserveQuotes)
0086     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'rxnNames'</span>,             <span class="string">'txt'</span>, pos(i), <span class="string">'  - name'</span>,                  preserveQuotes)
0087     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'S'</span>,                    <span class="string">'txt'</span>, pos(i), <span class="string">'  - metabolites'</span>,           preserveQuotes)
0088     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'lb'</span>,                   <span class="string">'num'</span>, pos(i), <span class="string">'  - lower_bound'</span>,           preserveQuotes)
0089     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'ub'</span>,                   <span class="string">'num'</span>, pos(i), <span class="string">'  - upper_bound'</span>,           preserveQuotes)
0090     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'grRules'</span>,              <span class="string">'txt'</span>, pos(i), <span class="string">'  - gene_reaction_rule'</span>,    preserveQuotes)
0091     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'rxnFrom'</span>,              <span class="string">'txt'</span>, pos(i), <span class="string">'  - rxnFrom'</span>,               preserveQuotes)
0092     <span class="keyword">if</span> model.c(i)~=0
0093         <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'c'</span>,                    <span class="string">'num'</span>, pos(i), <span class="string">'  - objective_coefficient'</span>, preserveQuotes)    
0094     <span class="keyword">end</span>
0095     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'eccodes'</span>,              <span class="string">'txt'</span>, pos(i), <span class="string">'  - eccodes'</span>,               preserveQuotes)
0096     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'rxnReferences'</span>,        <span class="string">'txt'</span>, pos(i), <span class="string">'  - references'</span>,            preserveQuotes)
0097     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'subSystems'</span>,           <span class="string">'txt'</span>, pos(i), <span class="string">'  - subsystem'</span>,             preserveQuotes)
0098     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'rxnMiriams'</span>,           <span class="string">'txt'</span>, pos(i), <span class="string">'  - annotation'</span>,            preserveQuotes)
0099     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'rxnConfidenceScores'</span>,  <span class="string">'num'</span>, pos(i), <span class="string">'  - confidence_score'</span>,      preserveQuotes)
0100 <span class="keyword">end</span>
0101 
0102 <span class="comment">%Genes:</span>
0103 fprintf(fid,<span class="string">'- genes:\n'</span>);
0104 <span class="keyword">if</span> sortIds==true
0105     [~,pos] = sort(model.genes);
0106 <span class="keyword">else</span>
0107     pos = 1:numel(model.genes);
0108 <span class="keyword">end</span>
0109 <span class="keyword">for</span> i = 1:length(model.genes)
0110     fprintf(fid,<span class="string">'    - !!omap\n'</span>);
0111     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'genes'</span>,          <span class="string">'txt'</span>, pos(i), <span class="string">'  - id'</span>,         preserveQuotes)
0112     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'geneShortNames'</span>, <span class="string">'txt'</span>, pos(i), <span class="string">'  - name'</span>,       preserveQuotes)
0113     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'geneMiriams'</span>,    <span class="string">'txt'</span>, pos(i), <span class="string">'  - annotation'</span>, preserveQuotes)
0114 <span class="keyword">end</span>
0115 
0116 <span class="comment">%Compartments:</span>
0117 fprintf(fid,<span class="string">'- compartments: !!omap\n'</span>);
0118 <span class="keyword">if</span> sortIds==true
0119     [~,pos] = sort(model.comps);
0120 <span class="keyword">else</span>
0121     pos = 1:numel(model.comps);
0122 <span class="keyword">end</span>
0123 <span class="keyword">for</span> i = 1:length(model.comps)
0124     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'compNames'</span>,   <span class="string">'txt'</span>, pos(i), [<span class="string">'- '</span> model.comps{pos(i)}], preserveQuotes)
0125     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'compMiriams'</span>, <span class="string">'txt'</span>, pos(i), <span class="string">'- annotation'</span>,             preserveQuotes)
0126 <span class="keyword">end</span>
0127 
0128 <span class="comment">%Close file:</span>
0129 fclose(fid);
0130 
0131 <span class="keyword">end</span>
0132 
0133 <a name="_sub1" href="#_subfunctions" class="code">function writeField(model,fid,fieldName,type,pos,name,preserveQuotes)</a>
0134 <span class="comment">%Writes a new line in the yaml file if the field exists and the field is</span>
0135 <span class="comment">%not empty at the correspoinding position. It's recursive for some fields</span>
0136 <span class="comment">%(metMiriams, rxnMiriams, and S)</span>
0137 
0138 <span class="keyword">if</span> isfield(model,fieldName)
0139     <span class="keyword">if</span> strcmp(fieldName,<span class="string">'metComps'</span>)
0140         <span class="comment">%metComps: write full name</span>
0141         fieldName = <span class="string">'comps'</span>;
0142         pos       = model.metComps(pos);
0143     <span class="keyword">end</span>
0144     
0145     field = eval([<span class="string">'model.'</span> fieldName]);
0146     
0147     <span class="keyword">if</span> strcmp(fieldName,<span class="string">'metMiriams'</span>)
0148         <span class="keyword">if</span> ~isempty(model.metMiriams{pos})
0149             fprintf(fid,[<span class="string">'    '</span> name <span class="string">': !!omap\n'</span>]);
0150             <span class="keyword">for</span> i=1:size(model.newMetMiriams,2)
0151                 <span class="comment">%'i' represents the different miriam names, e.g.</span>
0152                 <span class="comment">%kegg.compound or chebi</span>
0153                 <span class="keyword">if</span> ~isempty(model.newMetMiriams{pos,i})
0154                     <span class="comment">%As during the following writeField call the value of</span>
0155                     <span class="comment">%'i' would be lost, it is temporarily concatenated to</span>
0156                     <span class="comment">%'name' parameter, which will be edited later</span>
0157                     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'newMetMiriams'</span>, <span class="string">'txt'</span>, pos, [<span class="string">'  - '</span> model.newMetMiriamNames{i} <span class="string">'_'</span> num2str(i)], preserveQuotes)
0158                 <span class="keyword">end</span>
0159             <span class="keyword">end</span>
0160         <span class="keyword">end</span>
0161         
0162     <span class="keyword">elseif</span> strcmp(fieldName,<span class="string">'rxnMiriams'</span>)
0163         <span class="keyword">if</span> ~isempty(model.eccodes{pos}) || ~isempty(model.rxnMiriams{pos})
0164             fprintf(fid,[<span class="string">'    '</span> name <span class="string">': !!omap\n'</span>]);
0165             <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'eccodes'</span>,  <span class="string">'txt'</span>, pos, <span class="string">'  - ec-code'</span>, preserveQuotes)
0166             <span class="keyword">for</span> i=1:size(model.newRxnMiriams,2)
0167                 <span class="keyword">if</span> ~isempty(model.newRxnMiriams{pos,i})
0168                     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'newRxnMiriams'</span>, <span class="string">'txt'</span>, pos, [<span class="string">'  - '</span> model.newRxnMiriamNames{i} <span class="string">'_'</span> num2str(i)], preserveQuotes)
0169                 <span class="keyword">end</span>
0170             <span class="keyword">end</span>
0171         <span class="keyword">end</span>
0172         
0173     <span class="keyword">elseif</span> strcmp(fieldName,<span class="string">'geneMiriams'</span>)
0174         <span class="keyword">if</span> ~isempty(model.geneMiriams{pos})
0175             fprintf(fid,[<span class="string">'    '</span> name <span class="string">': !!omap\n'</span>]);
0176             <span class="keyword">for</span> i=1:size(model.newGeneMiriams,2)
0177                 <span class="keyword">if</span> ~isempty(model.newGeneMiriams{pos,i})
0178                     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'newGeneMiriams'</span>, <span class="string">'txt'</span>, pos, [<span class="string">'  - '</span> model.newGeneMiriamNames{i} <span class="string">'_'</span> num2str(i)], preserveQuotes)
0179                 <span class="keyword">end</span>
0180             <span class="keyword">end</span>
0181         <span class="keyword">end</span>
0182         
0183     <span class="keyword">elseif</span> strcmp(fieldName,<span class="string">'compMiriams'</span>)
0184         <span class="keyword">if</span> ~isempty(model.compMiriams{pos})
0185             fprintf(fid,[<span class="string">'    '</span> name <span class="string">': !!omap\n'</span>]);
0186             <span class="keyword">for</span> i=1:size(model.newCompMiriams,2)
0187                 <span class="keyword">if</span> ~isempty(model.newCompMiriams{pos,i})
0188                     <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'newCompMiriams'</span>, <span class="string">'txt'</span>, pos, [<span class="string">'  - '</span> model.newCompMiriamNames{i} <span class="string">'_'</span> num2str(i)], preserveQuotes)
0189                 <span class="keyword">end</span>
0190             <span class="keyword">end</span>
0191         <span class="keyword">end</span>
0192         
0193     <span class="keyword">elseif</span> strcmp(fieldName,<span class="string">'S'</span>)
0194         <span class="comment">%S: create header &amp; write each metabolite in a new line</span>
0195         fprintf(fid,[<span class="string">'    '</span> name <span class="string">': !!omap\n'</span>]);
0196         <span class="keyword">if</span> sum(field(:,pos) ~= 0) &gt; 0
0197             model.mets   = model.mets(field(:,pos) ~= 0);
0198             model.coeffs = field(field(:,pos) ~= 0,pos);
0199             <span class="comment">%Sort metabolites:</span>
0200             [model.mets,order] = sort(model.mets);
0201             model.coeffs       = model.coeffs(order);
0202             <span class="keyword">for</span> i = 1:length(model.mets)
0203                 <a href="#_sub1" class="code" title="subfunction writeField(model,fid,fieldName,type,pos,name,preserveQuotes)">writeField</a>(model, fid, <span class="string">'coeffs'</span>,  <span class="string">'num'</span>, i, [<span class="string">'      - '</span> model.mets{i}], preserveQuotes)
0204             <span class="keyword">end</span>
0205         <span class="keyword">end</span>
0206         
0207     <span class="keyword">elseif</span> sum(strcmp({<span class="string">'subSystems'</span>,<span class="string">'newMetMiriams'</span>,<span class="string">'newRxnMiriams'</span>,<span class="string">'newGeneMiriams'</span>,<span class="string">'newCompMiriams'</span>},fieldName)) &gt; 0
0208         <span class="comment">%eccodes/rxnNotes: if 1 write in 1 line, if more create header and list</span>
0209         <span class="keyword">if</span> strcmp(fieldName,<span class="string">'subSystems'</span>)
0210             list = field{pos};  <span class="comment">%subSystems already comes in a cell array</span>
0211         <span class="keyword">elseif</span> strcmp(fieldName,<span class="string">'newMetMiriams'</span>)
0212             index = str2double(regexprep(name,<span class="string">'^.+_'</span>,<span class="string">''</span>));
0213             name  = regexprep(name,<span class="string">'_\d+$'</span>,<span class="string">''</span>);
0214             list = strsplit(model.newMetMiriams{pos,index},<span class="string">';'</span>);
0215         <span class="keyword">elseif</span> strcmp(fieldName,<span class="string">'newRxnMiriams'</span>)
0216             index = str2double(regexprep(name,<span class="string">'^.+_'</span>,<span class="string">''</span>));
0217             name  = regexprep(name,<span class="string">'_\d+$'</span>,<span class="string">''</span>);
0218             list = strsplit(model.newRxnMiriams{pos,index},<span class="string">';'</span>);
0219         <span class="keyword">elseif</span> strcmp(fieldName,<span class="string">'newGeneMiriams'</span>)
0220             index = str2double(regexprep(name,<span class="string">'^.+_'</span>,<span class="string">''</span>));
0221             name  = regexprep(name,<span class="string">'_\d+$'</span>,<span class="string">''</span>);
0222             list = strsplit(model.newGeneMiriams{pos,index},<span class="string">';'</span>);
0223         <span class="keyword">elseif</span> strcmp(fieldName,<span class="string">'newCompMiriams'</span>)
0224             index = str2double(regexprep(name,<span class="string">'^.+_'</span>,<span class="string">''</span>));
0225             name  = regexprep(name,<span class="string">'_\d+$'</span>,<span class="string">''</span>);
0226             list = strsplit(model.newCompMiriams{pos,index},<span class="string">';'</span>);
0227         <span class="keyword">else</span>
0228             list = strrep(field{pos},<span class="string">' '</span>,<span class="string">''</span>);     <span class="comment">%Exception for eccodes</span>
0229             list = strsplit(list,<span class="string">';'</span>);
0230         <span class="keyword">end</span>
0231 
0232         <span class="keyword">if</span> length(list) == 1 &amp;&amp; ~strcmp(list{1},<span class="string">''</span>) &amp;&amp; ~strcmp(fieldName,<span class="string">'subSystems'</span>)
0233             <span class="keyword">if</span> preserveQuotes
0234                 list = strcat(<span class="string">'&quot;'</span>,list,<span class="string">'&quot;'</span>);
0235             <span class="keyword">end</span>
0236             fprintf(fid,[<span class="string">'    '</span> name <span class="string">': '</span> list{1} <span class="string">'\n'</span>]);
0237         <span class="keyword">elseif</span> length(list) &gt; 1 || strcmp(fieldName,<span class="string">'subSystems'</span>)
0238             <span class="keyword">if</span> preserveQuotes
0239                 list = strcat(<span class="string">'&quot;'</span>,list,<span class="string">'&quot;'</span>);
0240             <span class="keyword">end</span>
0241             fprintf(fid,[<span class="string">'    '</span> name <span class="string">':\n'</span>]);
0242             <span class="keyword">for</span> i = 1:length(list)
0243                 fprintf(fid,[<span class="string">'          - '</span> list{i} <span class="string">'\n'</span>]);
0244             <span class="keyword">end</span>
0245         <span class="keyword">end</span>
0246         
0247     <span class="keyword">elseif</span> sum(pos) &gt; 0
0248         <span class="comment">%All other fields:</span>
0249         <span class="keyword">if</span> strcmp(type,<span class="string">'txt'</span>)
0250             value = field{pos};
0251             <span class="keyword">if</span> preserveQuotes
0252                 value = strcat(<span class="string">'&quot;'</span>,value,<span class="string">'&quot;'</span>);
0253             <span class="keyword">end</span>
0254         <span class="keyword">elseif</span> strcmp(type,<span class="string">'num'</span>)
0255             <span class="keyword">if</span> isnan(field(pos))
0256                 value = [];
0257             <span class="keyword">else</span>
0258                 value = num2str(field(pos),12);
0259             <span class="keyword">end</span>
0260         <span class="keyword">end</span>
0261         <span class="keyword">if</span> ~isempty(value)
0262             fprintf(fid,[<span class="string">'    '</span> name <span class="string">': '</span> value <span class="string">'\n'</span>]);
0263         <span class="keyword">end</span>
0264     <span class="keyword">end</span>
0265 <span class="keyword">end</span>
0266 
0267 
0268 <span class="keyword">end</span>
0269 
0270 <a name="_sub2" href="#_subfunctions" class="code">function writeMetadata(model,fid)</a>
0271 <span class="comment">% Writes model metadata to the yaml file. This information will eventually</span>
0272 <span class="comment">% be extracted entirely from the model, but for now, many of the entries</span>
0273 <span class="comment">% are hard-coded defaults for HumanGEM.</span>
0274 
0275 fprintf(fid, <span class="string">'- metaData:\n'</span>);
0276 fprintf(fid, [<span class="string">'    id: &quot;'</span>,          model.id,          <span class="string">'&quot;\n'</span>]);
0277 fprintf(fid, [<span class="string">'    name: &quot;'</span>,        model.name, <span class="string">'&quot;\n'</span>]);
0278 <span class="keyword">if</span> isfield(model,<span class="string">'version'</span>)
0279     fprintf(fid, [<span class="string">'    version: &quot;'</span>, model.version,     <span class="string">'&quot;\n'</span>]);
0280 <span class="keyword">end</span>
0281 fprintf(fid, [<span class="string">'    date: &quot;'</span>,        datestr(now,29),   <span class="string">'&quot;\n'</span>]);  <span class="comment">% 29=YYYY-MM-DD</span>
0282 <span class="keyword">if</span> isfield(model,<span class="string">'annotation'</span>)
0283     <span class="keyword">if</span> isfield(model.annotation,<span class="string">'defaultLB'</span>)
0284         fprintf(fid, [<span class="string">'    defaultLB: &quot;'</span>,    num2str(model.annotation.defaultLB), <span class="string">'&quot;\n'</span>]);
0285     <span class="keyword">end</span>
0286     <span class="keyword">if</span> isfield(model.annotation,<span class="string">'defaultUB'</span>)
0287         fprintf(fid, [<span class="string">'    defaultUB: &quot;'</span>,    num2str(model.annotation.defaultUB), <span class="string">'&quot;\n'</span>]);
0288     <span class="keyword">end</span>
0289     <span class="keyword">if</span> isfield(model.annotation,<span class="string">'givenName'</span>)
0290         fprintf(fid, [<span class="string">'    givenName: &quot;'</span>,    model.annotation.givenName,          <span class="string">'&quot;\n'</span>]);
0291     <span class="keyword">end</span>
0292     <span class="keyword">if</span> isfield(model.annotation,<span class="string">'familyName'</span>)
0293         fprintf(fid, [<span class="string">'    familyName: &quot;'</span>,   model.annotation.familyName,         <span class="string">'&quot;\n'</span>]);
0294     <span class="keyword">end</span>
0295     <span class="keyword">if</span> isfield(model.annotation,<span class="string">'authors'</span>)
0296         fprintf(fid, [<span class="string">'    authors: &quot;'</span>,      model.annotation.authors,            <span class="string">'&quot;\n'</span>]);
0297     <span class="keyword">end</span>
0298     <span class="keyword">if</span> isfield(model.annotation,<span class="string">'email'</span>)
0299         fprintf(fid, [<span class="string">'    email: &quot;'</span>,        model.annotation.email,              <span class="string">'&quot;\n'</span>]);
0300     <span class="keyword">end</span>
0301     <span class="keyword">if</span> isfield(model.annotation,<span class="string">'organization'</span>)
0302         fprintf(fid, [<span class="string">'    organization: &quot;'</span>, model.annotation.organization,       <span class="string">'&quot;\n'</span>]);
0303     <span class="keyword">end</span>
0304     <span class="keyword">if</span> isfield(model.annotation,<span class="string">'taxonomy'</span>)
0305         fprintf(fid, [<span class="string">'    taxonomy: &quot;'</span>,     model.annotation.taxonomy,           <span class="string">'&quot;\n'</span>]);
0306     <span class="keyword">end</span>
0307     <span class="keyword">if</span> isfield(model.annotation,<span class="string">'note'</span>)
0308         fprintf(fid, [<span class="string">'    note: &quot;'</span>,         model.annotation.note,               <span class="string">'&quot;\n'</span>]);
0309     <span class="keyword">end</span>
0310     <span class="keyword">if</span> isfield(model.annotation,<span class="string">'sourceUrl'</span>)
0311         fprintf(fid, [<span class="string">'    sourceUrl: &quot;'</span>,    model.annotation.sourceUrl,          <span class="string">'&quot;\n'</span>]);
0312     <span class="keyword">end</span>
0313 <span class="keyword">end</span>
0314 <span class="keyword">end</span></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>